<html><head><meta http-equiv=content-type content="text/html; charset=utf-8"><meta name=viewport content="width=device-width,initial-scale=1"><title>BrewPiLess reporting for duty!</title><meta name=apple-mobile-web-app-title content=BrewPiLess><meta name=apple-mobile-web-app-capable content=yes><script src=http://cdnjs.cloudflare.com/ajax/libs/dygraph/1.1.1/dygraph-combined.js></script><script>function invoke(n){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==e.readyState&&(200==e.status?n.success(e.responseText):e.onerror(e.status))},e.ontimeout=function(){void 0!==n.timeout?n.timeout():e.onerror(-1)},e.onerror=function(e){void 0!==n.fail&&n.fail(e)},e.open(n.m,n.url,!0),void 0!==n.data?(e.setRequestHeader("Content-Type",void 0!==n.mime?n.mime:"application/x-www-form-urlencoded"),e.send(n.data)):e.send()}var BWF={BrewProfile:"/brewing.json",sse:!0,process:function(msg){if(null==this.raw){eval("m={"+msg+"}");for(var key in m)void 0!==this.handlers[key]&&this.handlers[key](m[key])}else this.raw(msg)},on:function(n,e){this.handlers[n]=e},send:function(n,e){e=void 0===e?{}:e;var o=this;invoke({m:"POST",url:"/putline",mime:"application/x-www-form-urlencoded",data:"data="+encodeURI(n),success:function(){void 0!==e.success&&e.success()},fail:function(n){void 0!==e.fail?e.fail(n):o.error(n)}})},connect:function(){var n=this,e=new EventSource("/getline");e.onmessage=function(e){n.process(e.data)},e.onerror=function(){n.error(-2),e.close(),setTimeout(function(){n.connect()},5e3)},e.onopen=function(){n.onconnect()},this.es=e},reconnect:function(){this.sse&&(this.es.close(),this.connect())},init:function(n){var e=this;if(e.error=void 0===n.error?function(){}:n.error,e.handlers=void 0===n.handlers?{}:n.handlers,e.raw=void 0===n.raw?null:n.raw,e.onconnect=void 0===n.onconnect?function(){}:n.onconnect,"undefined"!=typeof EventSource)e.connect();else{console.log("not support SSE"),e.sse=!1;var o=void 0===n.polling?5e3:n.polling;setInterval(function(){invoke({m:"GET",url:"/getline_p",success:function(n){e.process(n)},fail:function(n){e.error(n)}})},o)}},save:function(n,e,o,t){invoke({m:"POST",url:"/fputs",data:"path="+n+"&content="+encodeURIComponent(e),success:function(){o()},fail:function(n){t(n)}})},load:function(n,e,o){invoke({m:"GET",url:n,success:function(n){e(n)},fail:function(n){o(n)}})}}</script><script>function s_ajax(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==e.readyState&&(200==e.status?t.success(e.responseText):e.onerror(e.status))},e.ontimeout=function(){void 0!==t.timeout?t.timeout():e.onerror(-1)},e.onerror=function(e){void 0!==t.fail&&t.fail(e)},e.open(t.m,t.url,!0),void 0!==t.data?(e.setRequestHeader("Content-Type",void 0!==t.mime?t.mime:"application/x-www-form-urlencoded"),e.send(t.data)):e.send()}function fgstate(t){var e={0:"red",12:"orange",24:"yellow",48:"green"};Q("#fgstate").style.backgroundColor=e[t]}function checkfgstate(){fgstate(GravityTracker.stable(12)?GravityTracker.stable(24)?GravityTracker.stable(48)?48:24:12:0)}function formatDate(t){function e(t){return t<10?"0"+t:t}var i=t.getHours(),n=t.getMinutes();return t.toLocaleDateString()+" "+e(i)+":"+e(n)}function saveprofile(){var t=profileEditor.getProfile();if(!1!==t){var e=JSON.stringify(t);console.log("result="+e),BWF.save(BWF.BrewProfile,encodeURIComponent(e),function(){profileEditor.markdirty(!1),alert("Done.")},function(t){alert("save failed:"+t)})}else alert("invalid value. check again")}function C2F(t){return Math.round(10*(1.8*t+32))/10}function F2C(t){return Math.round((t-32)/1.8*10)/10}function updateTempUnit(t){for(var e=document.getElementsByClassName("t_unit"),i=0;i<e.length;i++)e[i].innerHTML=t}function openDlgLoading(){document.getElementById("dlg_loading").style.display="block"}function closeDlgLoading(){document.getElementById("dlg_loading").style.display="none"}function onload(t){function e(){function e(){i&&(i=!1,closeDlgLoading(),t())}var i=!0;invoke({url:"/tcc",m:"GET",fail:function(t){console.log("error connect to BrwePiLess!"),e()},success:function(t){var i=JSON.parse(t),n={valid:!0,minDegree:i.tempSetMin,maxDegree:i.tempSetMax,tempUnit:i.tempFormat};n.tempUnit!=BrewPiSetting.tempUnit&&(updateTempUnit(n.tempUnit),profileEditor.setTempUnit(n.tempUnit)),BrewPiSetting=n,e()}})}modekeeper.init(),openDlgLoading(),BWF.load(BWF.BrewProfile,function(t){try{var i=JSON.parse(t);updateTempUnit(i.u),BrewPiSetting.tempUnit=i.u,profileEditor.initProfile(i),ControlChart.init("tc_chart",profileEditor.chartdata(),i.u)}catch(t){console.log("error:"+t),profileEditor.initProfile(),ControlChart.init("tc_chart",profileEditor.chartdata(),profileEditor.tempUnit)}e()},function(t){profileEditor.initProfile(),ControlChart.init("tc_chart",profileEditor.chartdata(),profileEditor.tempUnit),e()})}function getLogName(){s_ajax({url:"loglist.php",m:"GET",success:function(t){var e=JSON.parse(t);e.rec?Q("#recording").innerHTML=e.log:Q("#recording").innerHTML=""},fail:function(t){alert("failed:"+t)}})}function setLcdText(t,e){document.getElementById(t).innerHTML=e}function communicationError(){setLcdText("lcd-line-0","Failed to"),setLcdText("lcd-line-1","connect to"),setLcdText("lcd-line-2","Server"),setLcdText("lcd-line-3","")}function controllerError(){setLcdText("lcd-line-0","Controller not"),setLcdText("lcd-line-1","updating data"),setLcdText("lcd-line-2","..."),setLcdText("lcd-line-3","")}function gravityDevice(t){if(void 0!==t.name){if(t.name.startsWith("iSpindel")){void 0===window.iSpindel&&(window.iSpindel=!0,Q("#ispindel-pane").style.display="block"),Q("#iSpindel-name").innerHTML=t.name,void 0!==t.battery&&(Q("#iSpindel-battery").innerHTML=t.battery);var e;e=void 0!==t.lu?new Date(1e3*t.lu):new Date,Q("#iSpindel-last").innerHTML=formatDate(e),void 0!==t.sg&&updateGravity(t.sg),void 0!==t.angle&&console.log("iSpindel:"+JSON.stringify(t))}void 0!==t.lpf&&GravityFilter.setBeta(t.lpf),void 0!==t.stpt&&GravityTracker.setThreshold(t.stpt)}}function init(){BChart.init("div_g");var t=!0;onload(function(){BWF.init({onconnect:function(){BWF.send("l"),setInterval(function(){t||controllerError(),BWF.send("l"),t=!1},5e3)},error:function(t){communicationError()},handlers:{L:function(e){t=!0;for(var i=0;i<4;i++)setLcdText("lcd-line-"+i,e[i])},V:function(t){console.log("forced reload chart"),BChart.reqnow()},G:function(t){gravityDevice(t)}}}),BChart.start()})}function updateGravity(t){window.sg=t,Q("#gravity-sg").innerHTML=t.toFixed(3),void 0!==window.og&&(Q("#gravity-att").innerHTML=BrewMath.att(window.og,t),Q("#gravity-abv").innerHTML=BrewMath.abv(window.og,t))}function updateOriginGravity(t){void 0!==window.og&&window.og==t||(window.og=t,Q("#gravity-og").innerHTML=t.toFixed(3),void 0!==window.sg&&updateGravity(window.sg))}function showgravitydlg(t){Q("#dlg_addgravity .msg").innerHTML=t,Q("#dlg_addgravity").style.display="block"}function dismissgravity(){Q("#dlg_addgravity").style.display="none"}function inputgravity(){var t=parseFloat(Q("#dlg_addgravity input").value);if(!(t<.8||t>1.25)){dismissgravity(),openDlgLoading(),window.isog?updateOriginGravity(t):updateGravity(t);var e={name:"webjs",gravity:t};window.isog&&(e.og=1),s_ajax({url:"gravity",m:"POST",mime:"application/json",data:JSON.stringify(e),success:function(t){closeDlgLoading()},fail:function(t){alert("failed:"+t),closeDlgLoading()}})}}function inputSG(){window.isog=!1,showgravitydlg("Add gravity Record:")}function inputOG(){window.isog=!0,showgravitydlg("Set Original Gravity:")}var Q=function(t){return document.querySelector(t)},GravityFilter={b:.1,y:0,add:function(t){return 0==this.y?this.y=t:this.y=this.y+this.b*(t-this.y),Math.round(1e4*this.y)/1e4},setBeta:function(t){this.b=t}},GravityTracker={NumberOfSlots:48,InvalidValue:255,ridx:0,record:[],threshold:1,setThreshold:function(t){this.threshold=t},addRecord:function(t){this.record[this.ridx++]=t,this.ridx>=this.NumberOfSlots&&(this.ridx=0)},stable:function(t,e){e=void 0===e?this.threshold:e;var i=this.ridx-1;i<0&&(i=this.NumberOfSlots-1);for(var n=this.NumberOfSlots+this.ridx-t;n>=this.NumberOfSlots;)n-=this.NumberOfSlots;return this.record[n]-this.record[i]<=e},Period:3600,init:function(){this.curerntStart=0,this.lastValue=0},add:function(t,e){gravity=Math.round(1e3*t,1);var i=e-this.curerntStart;if(i>this.Period){if(this.addRecord(gravity),0!=this.lastValue)for(i-=this.Period;i>this.Period;)i-=this.Period,this.addRecord(this.lastValue);this.curerntStart=e,this.lastValue=gravity}}},BrewChart=function(t){this.cid=t,this.ctime=0,this.interval=60,this.numLine=7,this.lidx=0,this.celius=!0,this.clearData()};BrewChart.prototype.clearData=function(){this.laststat=[NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN],this.sg=NaN,this.og=NaN},BrewChart.prototype.setCelius=function(t){this.celius=t,this.ylabel(STR.ChartLabel+"("+(t?"째C":"째F")+")")},BrewChart.prototype.incTime=function(){this.ctime+=this.interval},BrewChart.prototype.formatDate=function(t){function e(t){return t>9?t:"0"+t}var i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.toLocaleDateString()+" "+e(i)+":"+e(n)+":"+e(r)},BrewChart.prototype.showLegend=function(t,e){var i=new Date(t);Q(".beer-chart-legend-time").innerHTML=this.formatDate(i),Q(".chart-legend-row.beer-temp .legend-value").innerHTML=this.tempFormat(this.chart.getValue(e,2)),Q(".chart-legend-row.beer-set .legend-value").innerHTML=this.tempFormat(this.chart.getValue(e,1)),Q(".chart-legend-row.fridge-temp .legend-value").innerHTML=this.tempFormat(this.chart.getValue(e,3)),Q(".chart-legend-row.fridge-set .legend-value").innerHTML=this.tempFormat(this.chart.getValue(e,4)),Q(".chart-legend-row.room-temp .legend-value").innerHTML=this.tempFormat(this.chart.getValue(e,5)),Q(".chart-legend-row.aux-temp .legend-value").innerHTML=this.tempFormat(this.chart.getValue(e,6));var n=this.chart.getValue(e,7);Q(".chart-legend-row.gravity .legend-value").innerHTML=!n||isNaN(n)?"--":n.toFixed(4);var r=this.chart.getValue(e,8);Q(".chart-legend-row.filtersg .legend-value").innerHTML=!r||isNaN(r)?"--":r.toFixed(4);var a=parseInt(this.state[e]);isNaN(a)||(Q(".beer-chart-state").innerHTML=STATES[a].text)},BrewChart.prototype.hideLegend=function(){document.querySelectorAll(".legend-value").forEach(function(t){t.innerHTML="--"}),Q(".beer-chart-legend-time").innerHTML=this.dateLabel,Q(".beer-chart-state").innerHTML="state"},BrewChart.prototype.tempFormat=function(t){var e=parseFloat(t);if(isNaN(e))return"--";var i=this.celius?"째C":"째F";return parseFloat(e).toFixed(2)+i},BrewChart.prototype.initLegend=function(){this.dateLabel=Q(".beer-chart-legend-time").innerHTML},BrewChart.prototype.toggleLine=function(t){this.shownlist[t]=!this.shownlist[t],this.shownlist[t]?this.chart.setVisibility(this.chart.getPropertiesForSeries(t).column-1,!0):this.chart.setVisibility(this.chart.getPropertiesForSeries(t).column-1,!1)},BrewChart.prototype.createChart=function(){var t=this;t.initLegend(),t.shownlist={beerTemp:!0,beerSet:!0,fridgeSet:!0,fridgeTemp:!0,roomTemp:!0,gravity:!0,auxTemp:!0,filtersg:!0};var e=document.createElement("div");e.className="hide",document.body.appendChild(e);var i={labels:BrewChart.Labels,colors:BrewChart.Colors,connectSeparatedPoints:!0,ylabel:"Temperature",y2label:"Gravity",series:{gravity:{axis:"y2",drawPoints:!0,pointSize:2,highlightCircleSize:4},filtersg:{axis:"y2"}},axisLabelFontSize:12,animatedZooms:!0,gridLineColor:"#ccc",gridLineWidth:"0.1px",labelsDiv:e,labelsDivStyles:{display:"none"},displayAnnotations:!0,strokeWidth:1,axes:{y:{valueFormatter:function(e){return t.tempFormat(e)}},y2:{valueFormatter:function(t){return t.toFixed(3)},axisLabelFormatter:function(t){return t.toFixed(3).substring(1)}}},highlightCircleSize:2,highlightSeriesOpts:{strokeWidth:1.5,strokeBorderWidth:1,highlightCircleSize:5},highlightCallback:function(e,i,n,r){t.showLegend(i,r)},unhighlightCallback:function(e){t.hideLegend()}};t.chart=new Dygraph(document.getElementById(t.cid),t.data,i)};var STATES=[{name:"IDLE",text:"Idle"},{name:"STATE_OFF",text:"Off"},{name:"DOOR_OPEN",text:"Door Open",doorOpen:!0},{name:"HEATING",text:"Heating"},{name:"COOLING",text:"Cooling"},{name:"WAITING_TO_COOL",text:"Waiting to Cool",waiting:!0},{name:"WAITING_TO_HEAT",text:"Waiting to Heat",waiting:!0},{name:"WAITING_FOR_PEAK_DETECT",text:"Waiting for Peak",waiting:!0},{name:"COOLING_MIN_TIME",text:"Cooling Min Time",extending:!0},{name:"HEATING_MIN_TIME",text:"Heating Min Time",extending:!0}];BrewChart.Mode={b:"Beer Constant",f:"Fridge Constant",o:"Off",p:"Profile"},BrewChart.Labels=["Time","beerSet","beerTemp","fridgeTemp","fridgeSet","roomTemp","auxTemp","gravity","filtersg"],BrewChart.prototype.addMode=function(t){var e=String.fromCharCode(t);this.anno.push({series:"beerTemp",x:1e3*this.ctime,shortText:e.toUpperCase(),text:BrewChart.Mode[e],attachAtBottom:!0})},BrewChart.testData=function(t){if(255!=t[0])return!1;var e=7&t[1];return 5==e&&{sensor:e,f:16&t[1]}},BrewChart.prototype.addResume=function(t){this.ctime+=60*t,this.anno.push({series:"beerTemp",x:1e3*this.ctime,shortText:"R",text:"Resume",attachAtBottom:!0})},BrewChart.prototype.process=function(t){var e=!1,i=this;i.filterSg=null;for(var n=0;n<t.length;){var r=t[n++],a=t[n++];if(255==r){if(5!=(15&a))return void alert("log version mismatched!");i.celius=!(16&a);var o=t[n++];o=256*o+t[n++],i.interval=o,i.starttime=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3],i.ctime=i.starttime,n+=4,i.data=[],i.anno=[],i.state=[],i.cstate=0,this.clearData(),e=!0,GravityTracker.init()}else if(244==r)i.addMode(a);else if(241==r)i.cstate=a;else if(254==r){if(i.lidx){var s;for(s=i.lidx;s<i.numLine;s++)i.dataset.push(NaN);i.data.push(i.dataset)}i.lidx=0,i.addResume(a)}else if(248==r){var l=256*(127&t[n++])+t[n++];i.og=l/1e4}else if(240==r){i.changes=a,i.lidx=0;var d=new Date(1e3*this.ctime);i.incTime(),i.dataset=[d],i.processRecord()}else if(r<128){var c=256*r+a;i.lidx==i.numLine-1?(c=32767==c?NaN:c>8e3?c/1e4:c/1e3,i.sg=c,isNaN(c)||(i.filterSg=GravityFilter.add(c),GravityTracker.add(i.filterSg,i.ctime))):(c=32767==c?NaN:c/100)>=225&&(c=225-c),i.lidx<i.numLine?void 0!==i.dataset?(i.dataset.push(c),i.laststat[i.lidx]=i.lidx>=i.numLine-2?null:c,i.lidx++,i.processRecord()):console.log("Error: missing tag."):console.log("Error: data overlap?")}}return void 0===i.chart?i.createChart():i.chart.updateOptions({file:i.data}),i.chart.setAnnotations(i.anno),e},BrewChart.prototype.processRecord=function(){for(var t=this;0==(1<<t.lidx&t.changes)&&t.lidx<t.numLine;)t.dataset.push(t.laststat[t.lidx]),t.lidx++;t.lidx>=t.numLine&&(isNaN(t.sg)?t.dataset.push(null):t.dataset.push(t.filterSg),t.data.push(t.dataset),t.state.push(t.cstate))};var profileEditor={dirty:!1,tempUnit:"C",C_startday_Id:"startdate",C_savebtn_Id:"savebtn",markdirty:function(t){this.dirty=t,document.getElementById(this.C_savebtn_Id).innerHTML=t?"Save*":"Save"},getStartDate:function(){return this.sd},setStartDate:function(t){},startDayChange:function(){var t=new Date(document.getElementById(this.C_startday_Id).value);isNaN(t.getTime())?document.getElementById(this.C_startday_Id).value=formatDate(this.sd):(this.sd=t,this.reorg(),this.markdirty(!0))},startnow:function(){var t=new Date;document.getElementById(this.C_startday_Id).value=formatDate(t),this.sd=t,this.reorg(),this.markdirty(!0)},rowList:function(){return document.getElementById("profile_t").getElementsByTagName("tbody")[0].getElementsByTagName("tr")},sgChange:function(t){!isNaN(t.innerHTML)||t.innerHTML.match(/^[\d]+%$/)||""==t.innerHTML?(t.saved=t.innerHTML,this.markdirty(!0)):t.innerHTML=t.saved},dayChange:function(t){""==t.innerHTML||isNaN(t.innerHTML)?t.innerHTML=t.saved:(this.markdirty(!0),this.reorg(),ControlChart.update(this.chartdata(),this.tempUnit))},tempChange:function(t){""==t.innerHTML||isNaN(t.innerHTML)?t.innerHTML=t.saved:(this.markdirty(!0),ControlChart.update(this.chartdata(),this.tempUnit))},stableChange:function(t){t.innerHTML.match(/^\s*(\d+)@(\d+)\s*$/)?(t.saved=t.innerHTML,this.markdirty(!0)):isNaN(t.innerHTML)?t.innerHTML=t.saved:(t.saved=parseInt(t.innerHTML),this.markdirty(!0))},initrow:function(t,e){var i=this,n=e.c;t.type=n;var r=t.getElementsByClassName("stage-temp")[0];"r"==n?r.innerHTML="":(r.innerHTML=e.t,r.contentEditable=!0,r.onblur=function(){i.tempChange(this)},r.onfocus=function(){this.saved=this.innerHTML});var a=t.getElementsByClassName("stage-time")[0];a.innerHTML=e.d,a.contentEditable=!0,a.onblur=function(){i.dayChange(this)},a.onfocus=function(){this.saved=this.innerHTML};var o=t.getElementsByClassName("stage-stabletime")[0],s=t.getElementsByClassName("stage-sg")[0];"r"==n?(s.innerHTML="",o.innerHTML=""):(s.saved=e.g,s.innerHTML=void 0===e.g?"":e.g,s.contentEditable=!0,s.onblur=function(){i.sgChange(this)},s.onfocus=function(){this.saved=this.innerHTML},void 0===e.s?o.innerHTML="":o.innerHTML=void 0===e.x?e.s:e.x+"@"+e.s,o.contentEditable=!0,o.onblur=function(){i.stableChange(this)},o.onfocus=function(){this.saved=this.innerHTML});var l=t.getElementsByClassName("for-time")[0],d=t.getElementsByClassName("condition")[0],c={t:0,g:1,a:3,s:2,o:4,u:5,v:6,b:7,x:8,w:9,e:10};"r"==n?(l.style.display="block",d.style.display="none"):(d.value=e.c,d.selectedIndex=c[e.c],l.style.display="none",d.style.display="block")},datestr:function(t){return formatDate(new Date(this.sd.getTime()+1e3*Math.round(86400*t)))},reorg:function(){for(var t=this.rowList(),e=this.sd.getTime(),i=0;i<t.length;i++){var n=t[i];n.className=i%2?"odd":"even",n.getElementsByClassName("diaplay-time")[0].innerHTML=formatDate(new Date(e));var r=this.rowTime(n);e+=1e3*Math.round(86400*r)}},chartdata:function(){var t=this.rowList();if(0==t.length)return[];var e=this.sd.getTime(),i=t[0],n=this.rowTemp(i),r=[];r.push([new Date(e),n]);for(var a=0;a<t.length;a++){var o;o="r"==(i=t[a]).type?this.rowTemp(t[a+1]):this.rowTemp(i),e+=1e3*Math.round(86400*this.rowTime(i)),r.push([new Date(e),o])}return r},addRow:function(){var t=document.getElementById("profile_t").getElementsByTagName("tbody")[0],e=t.getElementsByTagName("tr");if(e.length>=13)alert("Too many steps!");else{var i;if(0==e.length)i={c:"t",t:"C"==this.tempUnit?20:68,d:1,g:1.01};else{var n=e[e.length-1],r=this.row.cloneNode(!0);this.initrow(r,{c:"r",d:1}),t.appendChild(r),i={c:"t",t:this.rowTemp(n),d:1,g:""}}r=this.row.cloneNode(!0);this.initrow(r,i),t.appendChild(r),this.reorg(),this.markdirty(!0),ControlChart.update(this.chartdata(),this.tempUnit)}},delRow:function(){var t=this.rowList();if(0!=t.length){var e=t[t.length-1];if(t.length>1){var i=t[t.length-2];i.parentNode.removeChild(i)}e.parentNode.removeChild(e),this.markdirty(!0),ControlChart.update(this.chartdata(),this.tempUnit)}},rowTemp:function(t){return parseFloat(t.getElementsByClassName("stage-temp")[0].innerHTML)},rowCondition:function(t){return t.getElementsByClassName("condition")[0].value},rowTime:function(t){return parseFloat(t.getElementsByClassName("stage-time")[0].innerHTML)},rowSg:function(t){return t.getElementsByClassName("stage-sg")[0].saved},rowSt:function(t){var e=t.getElementsByClassName("stage-stabletime")[0].innerHTML;if("string"!=typeof e)return e;var i=e.match(/^\s*(\d+)@(\d+)\s*$/);return i?parseInt(i[2]):parseInt(e)},rowStsg:function(t){var e=t.getElementsByClassName("stage-stabletime")[0].innerHTML;if("string"!=typeof e)return!1;var i=e.match(/^\s*(\d+)@(\d+)\s*$/);return!!i&&parseInt(i[1])},renderRows:function(t){for(var e=document.getElementById("profile_t").getElementsByTagName("tbody")[0],i=0;i<t.length;i++){var n=this.row.cloneNode(!0);this.initrow(n,t[i]),e.appendChild(n)}this.reorg()},initable:function(t,e){this.sd=e,document.getElementById(this.C_startday_Id).value=formatDate(e);var i=document.getElementById("profile_t").getElementsByTagName("tbody")[0];this.row=i.getElementsByTagName("tr")[0],i.removeChild(this.row),this.renderRows(t)},clear:function(){for(var t=this.rowList(),e=(t.length,t.length-1);e>=0;e--){var i=t[e];i.parentNode.removeChild(i)}this.markdirty(!0)},getProfile:function(){for(var t=this.rowList(),e=[],i=0;i<t.length;i++){var n=t[i],r=this.rowTime(n);if(isNaN(r))return!1;if("r"==n.type)e.push({c:"r",d:r});else{var a=this.rowTemp(n);if(isNaN(a))return!1;if(a>BrewPiSetting.maxDegree||a<BrewPiSetting.minDegree)return!1;var o=this.rowCondition(n),s={c:o,d:r,t:a},l=this.rowSg(n);if("gaobxwe".indexOf(o)>=0){if(""==l)return!1;s.g=l}var d=this.rowSt(n);if("suvbxwe".indexOf(o)>=0){if(isNaN(d))return!1;s.s=d;var c=this.rowStsg(n);c&&(s.x=c)}e.push(s)}}return{s:this.sd.toISOString(),v:2,u:this.tempUnit,t:e}},loadProfile:function(t){this.sd=new Date(t.s),this.tempUnit=t.u,this.clear(),this.renderRows(t.t),ControlChart.update(this.chartdata(),this.tempUnit)},initProfile:function(t){if(void 0!==t){var e=new Date(t.s);this.tempUnit=t.u,profileEditor.initable(t.t,e)}else profileEditor.initable([],new Date)},setTempUnit:function(t){if(t!=this.tempUnit){this.tempUnit=t;for(var e=this.rowList(),i=0;i<e.length;i++){var n=e[i].querySelector("td.ptemp"),r=parseFloat(n.innerHTML);n.innerHTML="C"==t?F2C(r):C2F(r)}}}},PL={pl_path:"P",url_list:"/list",url_save:"/fputs",url_del:"/rm",url_load:"pl.php?ld=",div:"#profile-list-pane",shown:!1,initialized:!1,plist:[],path:function(t){return"/"+this.pl_path+"/"+t},depath:function(t){return t.substring(this.pl_path.length+1)},rm:function(t){var e=this,i="path="+e.path(e.plist[t]);s_ajax({url:e.url_del,m:"DELETE",data:i,success:function(i){e.plist.splice(t,1),e.list(e.plist)},fail:function(t){alert("failed:"+t)}})},load:function(t){var e=this;s_ajax({url:e.path(e.plist[t]),m:"GET",success:function(t){var e=JSON.parse(t);profileEditor.loadProfile(e)},fail:function(t){}})},list:function(t){for(var e,i=this,n=Q(i.div).querySelector("tbody");e=n.querySelector("tr:nth-of-type(1)");)n.removeChild(e);var r=i.row;t.forEach(function(t,e){var a=r.cloneNode(!0);a.querySelector(".profile-name").innerHTML=t,a.querySelector(".profile-name").onclick=function(t){return t.preventDefault(),i.load(e),!1},a.querySelector(".rmbutton").onclick=function(){i.rm(e)},n.appendChild(a)})},append:function(t){this.initialized&&(this.plist.push(t),this.list(this.plist))},init:function(){var t=this;t.initialized=!0,t.row=Q(t.div).querySelector("tr:nth-of-type(1)"),t.row.parentNode.removeChild(t.row),s_ajax({url:t.url_list,m:"POST",data:"dir="+t.path(""),success:function(e){t.plist=[],JSON.parse(e).forEach(function(e){"file"==e.type&&t.plist.push(t.depath(e.name))}),t.list(t.plist)},fail:function(t){alert("failed:"+t)}})},toggle:function(){this.initialized||this.init(),this.shown=!this.shown,this.shown?Q(this.div).style.left="0px":Q(this.div).style.left="-300px"},saveas:function(){Q("#dlg_saveas").style.display="block"},cancelSave:function(){Q("#dlg_saveas").style.display="none"},doSave:function(){var t=Q("#dlg_saveas input").value;if(""!=t&&!t.match(/[\W]/g)){var e=profileEditor.getProfile();if(!1!==e){var i=this,n="path="+i.path(t)+"&content="+encodeURIComponent(JSON.stringify(e));s_ajax({url:(i=this).url_save,m:"POST",data:n,success:function(e){i.append(t),i.cancelSave()},fail:function(t){alert("failed:"+t)}})}else alert("invalid value. check again")}}},BrewPiSetting={valid:!1,maxDegree:30,minDegree:0,tempUnit:"C"},ControlChart={unit:"C",init:function(t,e,i){var n=this;n.data=e,n.unit=i;n.chart=new Dygraph(document.getElementById(t),n.data,{colors:["rgb(89, 184, 255)"],axisLabelFontSize:12,gridLineColor:"#ccc",gridLineWidth:"0.1px",labels:["Time","Temperature"],labelsDiv:document.getElementById(t+"-label"),legend:"always",labelsDivStyles:{textAlign:"right"},strokeWidth:1,axes:{y:{valueFormatter:function(t){return t.toFixed(1)+"&deg;"+n.unit},pixelsPerLabel:20,axisLabelWidth:35},x:{axisLabelFormatter:function(t){d=new Date(t);var e=d.getYear()+1900,i=new RegExp("[^d]?"+e+"[^d]?");return d.toLocaleDateString().replace(i,"")},valueFormatter:function(t){return d=new Date(t),formatDate(d)},pixelsPerLabel:30,axisLabelWidth:40}},highlightCircleSize:2,highlightSeriesOpts:{strokeWidth:1.5,strokeBorderWidth:1,highlightCircleSize:5}})},update:function(t,e){0!=t.length&&(this.data=t,this.unit=e,this.chart.updateOptions({file:this.data}))}},modekeeper={initiated:!1,modes:["profile","beer","fridge","off"],cmode:0,dselect:function(t){var e=document.getElementById(t+"-m"),i=document.getElementById(t+"-m").className.replace(/\snav-selected/,"");e.className=i,document.getElementById(t+"-s").style.display="none"},select:function(t){document.getElementById(t+"-m").className+=" nav-selected",document.getElementById(t+"-s").style.display="block"},init:function(){var t=this;if(!t.initiated){t.initiated=!0;for(var e=0;e<4;e++){var i=t.modes[e];document.getElementById(i+"-s").style.display="none",document.getElementById(i+"-m").onclick=function(){var e=this.id.replace(/-m/,"");t.dselect(t.cmode),t.select(e),t.cmode=e}}t.cmode="profile",t.select(t.cmode)}},apply:function(){if(BrewPiSetting.valid||alert("Not connected to controller."),"beer"==this.cmode||"fridge"==this.cmode){var t=document.getElementById(this.cmode+"-t").value;if(""==t||isNaN(t)||t>BrewPiSetting.maxDegree||t<BrewPiSetting.minDegree)return void alert("Invalid Temperature:"+t);"beer"==this.cmode?BWF.send("j{mode:b, beerSet:"+t+"}"):(console.log("j{mode:f, fridgeSet:"+t+"}"),BWF.send("j{mode:f, fridgeSet:"+t+"}"))}else if("off"==this.cmode)BWF.send("j{mode:o}");else{if(profileEditor.dirty)return void alert("save the profile first before apply");document.getElementById("dlg_beerprofilereminder").style.display="block",document.getElementById("dlg_beerprofilereminder").querySelector("button.ok").onclick=function(){document.getElementById("dlg_beerprofilereminder").style.display="none";var t=parseFloat(Q("#dlg_beerprofilereminder input").value);updateOriginGravity(t);var e={name:"webjs",og:1,gravity:t};s_ajax({url:"gravity",m:"POST",mime:"application/json",data:JSON.stringify(e),success:function(t){BWF.send("j{mode:p}")},fail:function(t){alert("failed:"+t)}})},document.getElementById("dlg_beerprofilereminder").querySelector("button.oknog").onclick=function(){document.getElementById("dlg_beerprofilereminder").style.display="none",BWF.send("j{mode:p}")},document.getElementById("dlg_beerprofilereminder").querySelector("button.cancel").onclick=function(){document.getElementById("dlg_beerprofilereminder").style.display="none"}}}},BChart={offset:0,url:"chart.php",toggle:function(t){this.chart.toggleLine(t)},reqdata:function(){var t=this,e="offset="+t.offset;void 0!==t.startOff&&null!==t.startOff&&(e=e+"&index="+t.startOff);var i=new XMLHttpRequest;i.open("GET",t.url+"?"+e),i.timeout=5e3,i.ontimeout=function(t){console.error("Timeout!!")},i.responseType="arraybuffer",i.onload=function(e){if(404!=this.status){var n=new Uint8Array(this.response);if(0==n.length)return t.timer&&clearInterval(t.timer),t.timer=null,void setTimeout(function(){t.reqdata()},3e3);t.chart.process(n)?(t.offset=n.length,t.startOff=i.getResponseHeader("LogOffset"),getLogName()):t.offset+=n.length,isNaN(t.chart.og)||(updateOriginGravity(t.chart.og),t.chart.og=NaN),t.chart.sg&&!isNaN(t.chart.sg)&&(updateGravity(t.chart.sg),t.chart.sg=NaN,checkfgstate()),null==t.timer&&t.settimer()}else console.log("Error getting log data")},i.onerror=function(){console.log("error getting data."),setTimeout(function(){t.reqdata()},1e4)},i.send()},settimer:function(){var t=this;t.timer=setInterval(function(){t.reqdata()},1e3*t.chart.interval)},init:function(t){this.chart=new BrewChart(t)},timer:null,start:function(){this.running||(this.running=!0,this.offset=0,this.reqdata())},reqnow:function(){var t=this;t.timer&&clearInterval(t.timer),t.timer=null,t.reqdata()}},BrewMath={abv:function(t,e){return(76.08*(t-e)/(1.775-t)*(e/.794)).toFixed(1)},att:function(t,e){return Math.round((t-e)/(t-1)*100)},sg2pla:function(t){return 1111.14*t-616.868-630.272*t*t+135.997*t*t*t},pla2sg:function(t){return 1+t/(258.6-t/258.2*227.1)}}</script><style>*{box-sizing:border-box;margin:0;padding:0}a{text-decoration:none}html{line-height:1.5;font-family:Roboto,sans-serif;font-weight:400;color:rgba(0,0,0,.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}h1,h2,h3,h4,h5,h6{font-weight:400;line-height:1.1}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:inherit}h1{font-size:4.2rem;line-height:110%;margin:2.1rem 0 1.68rem 0}h2{font-size:3.56rem;line-height:110%;margin:1.78rem 0 1.424rem 0}h3{font-size:2.92rem;line-height:110%;margin:1.46rem 0 1.168rem 0}h4{font-size:2.28rem;line-height:110%;margin:1.14rem 0 .912rem 0}h5{font-size:1.64rem;line-height:110%;margin:.82rem 0 .656rem 0}h6{font-size:1rem;line-height:110%;margin:.5rem 0 .4rem 0}em{font-style:italic}strong{font-weight:500}small{font-size:75%}.light{font-weight:300}.thin{font-weight:200}[viewport]{padding:0 16px}html [layout],html [layout][horizontal],html [layout][vertical]{display:flex}html [layout][horizontal]{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}html [layout][vertical]{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}html [flex]{flex:1;flex-basis:.000000001px}html [layout][center-center],html [layout][cross-center]{align-items:center}html [layout][center-center],html [layout][main-center]{justify-content:center}html [layout][main-justified]{justify-content:space-between}html [layout][main-distributed]{justify-content:space-around}html [hidden]{display:none!important}html [relative]{position:relative}.header{height:64px;background:teal;box-shadow:0 1px 8px rgba(0,0,0,.3);padding:0 16px}.header_title{font-size:32px;line-height:64px;color:#fff;margin:0;padding:0}.header_version-display{font-size:14px;color:#fff}.options{list-style-type:none;height:100%}.options>li{display:inline-block;height:100%}.options a{color:#fff;text-transform:uppercase;height:100%;padding:8px;display:inline-block;line-height:48px}.options a.active{border-bottom:2px solid #ff0}.options a:hover{border-bottom:2px solid #fff}[subheader]{background:#00e6e6}.data-pane{list-style-type:none;display:block;width:100%;padding:0 8px;vertical-align:middle}.data-pane>li{display:inline-block;width:120px;vertical-align:middle}.data-pane>li.double{width:240px}.data-pane .descriptor{display:inline-block}.switch-input{display:none}.switch-label{position:relative;display:inline-block;min-width:148px;cursor:pointer;font-weight:500;text-align:left;margin:0;padding:4px 0 4px 44px}.switch-label:after,.switch-label:before{content:"";position:absolute;margin:0;outline:0;top:50%;-ms-transform:translate(0,-50%);-webkit-transform:translate(0,-50%);transform:translate(0,-50%);-webkit-transition:all .3s ease;transition:all .3s ease}.switch-label:before{left:1px;width:34px;height:14px;background-color:#9e9e9e;border-radius:8px}.switch-label:after{left:0;width:20px;height:20px;background-color:#fafafa;border-radius:50%;box-shadow:0 3px 1px -2px rgba(0,0,0,.14),0 2px 2px 0 rgba(0,0,0,.098),0 1px 5px 0 rgba(0,0,0,.084)}.switch-input:checked+.switch-label:before{background-color:#a5d6a7}.switch-input:checked+.switch-label:after{background-color:#4caf50;transform:translate(80%,-50%)}.switch-input:checked+label[for=beer-temp].switch-label:after{background-color:#29aa29}.switch-input:checked+label[for=beer-set].switch-label:after{background-color:#f06464}.switch-input:checked+label[for=fridge-temp].switch-label:after{background-color:#59b8ff}.switch-input:checked+label[for=fridge-set].switch-label:after{background-color:#ffa14c}.switch-input:checked+label[for=room-temp].switch-label:after{background-color:#aaa}.switch-input:checked+label[for=gravity].switch-label:after{background-color:#f5e127}.switch-input:checked+label[for=aux-temp].switch-label:after{background-color:#909}.switch-input:checked+label[for=filtersg].switch-label:after{background-color:#000abb}.chart{width:80%;height:390px}.chart-legend{list-style-type:none}.chart-legend-row{padding:8px 16px 0 16px}.chart-legend-row>div{display:inline-block}.chart-legend-row .toggle{width:12px;height:12px;margin-right:8px;border-radius:100%;border:1px solid #000}.chart-legend-row .toggle:hover{cursor:pointer}.chart-legend-row.time{background-color:#def;padding-bottom:8px}.legend-label{width:100px;font-weight:700}.legend-label:hover{cursor:pointer}.lcddisplay{width:280px;height:90px;margin:5px;background:#000;background:-moz-linear-gradient(top,#000 2%,#2b2b2b 11%,#212121 54%,#212121 92%,#000 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(2%,#000),color-stop(11%,#2b2b2b),color-stop(54%,#212121),color-stop(92%,#212121),color-stop(100%,#000));background:-webkit-linear-gradient(top,#000 2%,#2b2b2b 11%,#212121 54%,#212121 92%,#000 100%);background:-o-linear-gradient(top,#000 2%,#2b2b2b 11%,#212121 54%,#212121 92%,#000 100%);background:-ms-linear-gradient(top,#000 2%,#2b2b2b 11%,#212121 54%,#212121 92%,#000 100%);background:linear-gradient(top,#000 2%,#2b2b2b 11%,#212121 54%,#212121 92%,#000 100%);-webkit-box-shadow:inset 1px 1px 5px #333;-moz-box-shadow:inset 1px 1px 5px #333;box-shadow:inset 1px 1px 5px #333;border:2px solid #333;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px}.lcddisplay .lcd-text{margin:5px 16px}.lcd-line{clear:left;font-size:16px;font-weight:400;font-style:normal;font-family:"Courier New",Courier,monospace;color:#ff0;white-space:pre}#div_lb{display:none}.hide{display:none}#bottom-frame{height:380px}.navbar{margin:0;padding:.2em .2em 0;border:1px solid #4297d7;background:#5c9ccc;color:#fff;height:4em;display:block;position:relative}#set-mode-text{margin-left:2px;margin:.2em}.navitem{background:#dfeffc;font-weight:700;color:#2e6e9e;margin:.2em .2em 0 0;padding:.5em;border-top-right-radius:5px;border-top-left-radius:5px}.nav-selected{background:#fff;font-weight:700;color:#e17009;margin:.2em .2em 0 0;padding:.5em .5em .6em .5em}.navitems{display:block;margin-top:2em}#apply{background:#dfeffc;font-weight:700;color:#2e6e9e;margin:.2em .1em 0 0;padding:.5em}#containter{margin:.5em;width:965px}.profileTable td,th{padding:3px;text-align:center}.profileTable tbody TR.odd{background:#f7f7f7}.profileTable tbody TR.even{width:100%}.profileTable TH{border:1px solid #4297d7;background:#5c9ccc;color:#fff;font-weight:700}table.profileTable{width:100%}#bottom-frame button{color:#1d5987;background:#dfeffc;font-weight:700;border-radius:6px;margin:4px}#addbutton{width:120px}#header{width:968px}#clearbtn{width:18%}#savebtn{width:25%}#delbtn{width:18%}.modal{display:none;position:fixed;z-index:100;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}.modal-content{background-color:#fefefe;margin:auto;padding:10px;border:1px solid #888;width:340px;height:220px;border-radius:8px}#dlg_addgravity button{width:56px;margin-top:2px}#modekeeper-apply{margin-top:0}#profile-edit{margin:6px;width:510px;position:relative}#tc_chart{width:430px;height:280px;margin:6px}#profile-list-pane{position:absolute;background-color:#fafaf0;border-style:outset;border:solid 3px;height:100%;width:200px;overflow:auto;left:-300px;top:0;overflow:auto}#profile-list-pane td{white-space:nowrap;overflow:hidden}#profile-list-pane .rmbutton{color:red}#profile-list-pane a,#profile-list-pane u{text-decoration:none}#fgstate{width:10px;height:10px;border-radius:6px;margin:4px 0 0 0;border:0}</style></head><body onload=init()><header layout horizontal main-justified cross-center class=header><h1 class=header_title>BrewPiLess <span class=header_version-display>v2.1</span></h1><div id=recording></div><ul class=options><li><a href=/log>logs</a></li><li><a href=/setup.htm>setup</a></li><li><a href=/config>config</a></li><li><a href=/gdc>gravity</a></li></ul></header><div subheader><ul id=gravity-pane class="data-pane gravity-pane" viewport><li><strong class=descriptor>current data:</strong></li><li><span class=descriptor>OG:</span> <span id=gravity-og onclick=inputOG()>--</span></li><li><span class=descriptor>SG:</span> <span id=gravity-sg onclick=inputSG()>--</span><div id=fgstate></div></li><li><span class=descriptor>ATT:</span> <span id=gravity-att>--</span>%</li><li><span class=descriptor>ABV:</span> <span id=gravity-abv>--</span>%</li><li><span class=descriptor>Battery:</span> <span id=iSpindel-battery>--</span></li><li><span class=descriptor>Last Update:</span> <span id=iSpindel-last>--</span></li></ul></div><div viewport><h4>Name of the view</h4><div layout horizontal><div id=div_g class=chart></div><ul flex class=chart-legend><li layout horizontal main-justified class="chart-legend-row time"><span class=beer-chart-legend-time>Date/Time</span> <span class=beer-chart-state>state</span></li><li layout horizontal main-justified class="chart-legend-row beer-temp"><input type=checkbox id=beer-temp name=set-name class=switch-input checked><label onclick='BChart.toggle("beerTemp")' for=beer-temp class=switch-label>Beer Temp:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row beer-set"><input type=checkbox id=beer-set name=set-name class=switch-input checked><label onclick='BChart.toggle("beerSet")' for=beer-set class=switch-label>Beer Set:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row fridge-temp"><input type=checkbox id=fridge-temp name=set-name class=switch-input checked><label onclick='BChart.toggle("fridgeTemp")' for=fridge-temp class=switch-label>Fridge Temp:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row fridge-set"><input type=checkbox id=fridge-set name=set-name class=switch-input checked><label onclick='BChart.toggle("fridgeSet")' for=fridge-set class=switch-label>Fridge Set:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row room-temp"><input type=checkbox id=room-temp name=set-name class=switch-input checked><label onclick='BChart.toggle("roomTemp")' for=room-temp class=switch-label>Room Temp:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row aux-temp"><input type=checkbox id=aux-temp name=set-name class=switch-input checked><label onclick='BChart.toggle("auxTemp")' for=aux-temp class=switch-label>Aux Temp:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row gravity"><input type=checkbox id=gravity name=set-name class=switch-input checked><label onclick='BChart.toggle("gravity")' for=gravity class=switch-label>Gravity:</label><div class=legend-value>--</div></li><li layout horizontal main-justified class="chart-legend-row filtersg"><input type=checkbox id=filtersg name=set-name class=switch-input checked><label onclick='BChart.toggle("filtersg")' for=filtersg class=switch-label>Filter SG:</label><div class=legend-value>--</div></li></ul></div><br><br><br><br><br><br><br><br></div><div class=frame id=bottom-frame><div class=navbar id=header><div id=set-mode-text>Set temperature mode:</div><div class=navitems><span class=navitem id=profile-m>Beer profile</span> <span class=navitem id=beer-m>Beer Const.</span> <span class=navitem id=fridge-m>Fridge Const.</span> <span class=navitem id=off-m>Off</span> <button id=modekeeper-apply onclick=modekeeper.apply()>Apply</button></div></div><div id=containter><div id=profile-s class=detail><div id=profile-edit><div id=profile-list-pane><table><tr><td><button class=rmbutton>X</button><a href=# class=profile-name></a></td></tr></table></div><div><div><span>Start Date:</span><input size=16 id=startdate onchange=profileEditor.startDayChange()> <button id=setnow onclick=profileEditor.startnow()>Now</button> <button id=addbutton onclick=profileEditor.addRow()>Add</button></div></div><table class=profileTable id=profile_t><thead><tr><th>T(&deg;<span class=t_unit>C</span>)</th><th>Condition</th><th>Days</th><th>SG</th><th>Stable</th><th>Start Time</th></tr></thead><tbody><tr><td class=stage-temp>19</td><td><div class=for-time>Ramp</div><div class=condition-con><select class=condition><option value=t>Time</option><option value=g>SG</option><option value=s>Stable</option><option value=a>Time & SG</option><option value=o>Time OR SG</option><option value=u>Time OR Stable</option><option value=v>Time & Stable</option><option value=b>SG OR Stable</option><option value=x>SG & Stable</option><option value=w>ALL</option><option value=e>Either</option></select></div></td><td class=stage-time>7</td><td class=stage-sg>1.01</td><td class=stage-stabletime></td><td class=diaplay-time></td></tr></tbody></table><div><button id=delbtn onclick=profileEditor.delRow()>Delete</button> <button id=clearbtn onclick=profileEditor.clear()>Clear</button> <button id=loadbtn onclick=PL.toggle()>...</button> <button id=saveasbtn onclick=PL.saveas()>Save As</button> <button id=savebtn onclick=saveprofile()>Save</button></div></div><div id=tc_chart></div></div><div id=beer-s class=detail>Set Beer temp: <input size=6 id=beer-t>&deg;<span class=t_unit>C</span></div><div id=fridge-s class=detail>Set Fridge temp: <input size=6 id=fridge-t>&deg;<span class=t_unit>C</span></div><div id=off-s class=detail>Turning temperature controll Off.</div></div><div id=dlg_beerprofilereminder class=modal><div class=modal-content><p><span class=msg></span>Note: For Beer Profoile to work properly,<ol><li>Original Gravity Must be specified if SG is specified as percentage(%)</li><li>Local data log must be activated if stability of gravity reading is used.</li></ol>Original Gravity:<input size=6 value=1.0></p><div class=dialog-buttons><button class=oknog>OK, OG already set</button> <button class=ok>OK, Set OG</button> <button class=cancel>Cancel</button></div></div></div><div id=dlg_loading class=modal><div class=modal-content><p>Communicating with BrewPiLess controller..</p></div></div><div id=dlg_addgravity class=modal><div class=modal-content><p><span class=msg></span><input size=6 value=1.0></p><div class=dialog-buttons><button onclick=dismissgravity()>Cancel</button> <button onclick=inputgravity()>OK</button></div></div></div><div id=dlg_saveas class=modal><div class=modal-content><span class=msg>Save Profile As</span><br><input size=32><br>*No special letters and space allowed. <button onclick=PL.cancelSave()>Cancel</button> <button onclick=PL.doSave()>OK</button></div></div></div></body></html>