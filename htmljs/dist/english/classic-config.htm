<!DOCTYPE html><html lang="en"><head><title> BrewPiLess Configuration </title><script>function s_ajax(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&(200==t.status?e.success(t.responseText):t.onerror(t.status))},t.ontimeout=function(){void 0!==e.timeout?e.timeout():t.onerror(-1)},t.onerror=function(t){void 0!==e.fail&&e.fail(t)},t.open(e.m,e.url,!0),void 0!==e.data?(t.setRequestHeader("Content-Type",void 0!==e.mime?e.mime:"application/x-www-form-urlencoded"),t.send(e.data)):t.send()}var Q=function(e){return document.querySelector(e)}</script><script>function formatIP(e){return"0.0.0.0"==e?"":e}function verifyIP(e){var a=this.value.split("."),t=!0;if(4==a.length)for(var i=0;i<4;i++){if(parseInt(a[i])>255){t=!1;break}}else t=""==this.value;t?(this.saved=this.value,this.value=formatIP(this.value)):this.value=formatIP(this.saved)}function loadSetting(){s_ajax({url:"config?cfg=1",m:"GET",success:function(e){var a=JSON.parse(e);window.oridata=a,Object.keys(a).map(function(e){var t=Q("input[name="+e+"]");t?t.classList.contains("iptype")?(t.value=formatIP(a[e]),t.saved=a[e],t.onchange=verifyIP):"checkbox"==t.type?t.checked=0!=a[e]:t.value=a[e]:(t=Q("select[name="+e+"]"))&&(t.value=a[e])})},fail:function(e){alert("error getting data:"+e)}})}function waitrestart(){Q("#waitprompt").style.display="block",Q("#inputform").style.display="none",setTimeout(function(){window.location.reload()},15e3)}function save(){var e=document.querySelectorAll("input"),a={},t=!1;Object.keys(e).map(function(i,n){var o;"submit"!=e[n].type&&(e[n].name&&""!=e[n].name&&(o=e[n].classList.contains("iptype")?e[n].saved:"checkbox"==e[n].type?e[n].checked?1:0:e[n].value.trim(),a[e[n].name]=o,window.oridata[e[n].name]==o||e[n].classList.contains("nb")||(t=!0)))});var i=Q("select[name=wifi]");window.oridata.wifi!=i.value&&(t=!0),a.wifi=i.value,console.log(JSON.stringify(a)),s_ajax({url:"config"+(t?"":"?nb"),data:"data="+encodeURIComponent(JSON.stringify(a)),m:"POST",success:function(e){t&&waitrestart()},fail:function(e){alert("error saving data:"+e)}})}function load(){Q("#verinfo")&&(Q("#verinfo").innerHTML="v"+JSVERSION),loadSetting()}</script><style>#waitprompt{display:none}</style></head><body onload=load()><div id=waitprompt> Congfiuration saved. Wait for restart... (note: if the hostname is changed, the page won't be reloaded.) </div><div id=inputform><form action=/setconfig action=post><table><tr><td> LCD auto off </td><td><input name=aoff type=text size=5 maxlength=5 class=nb> seconds </td></tr><tr><td> Title </td><td><input name=title type=text size=12 maxlength=24></td></tr><tr><td> Host/Network Name </td><td><input name=name type=text size=12 maxlength=16></td></tr><tr><td> HTTP Port </td><td><input name=port type=text size=5 maxlength=5></td></tr><tr><td> User Name </td><td><input name=user type=text size=12 maxlength=16></td></tr><tr><td> Password </td><td><input name=pass type=password size=12 maxlength=16></td></tr><tr><td> Always ask for password </td><td><input type=checkbox name=protect></td></tr><tr><td> Network </td><td><select name=wifi><option value=1>Station</option><option value=2>AP</option><option value=3>Station + AP</option></select></td></tr><tr><td> Fixed IP </td><td><input type=text name=ip size=16 class=iptype></td></tr><tr><td> Gateway </td><td><input type=text name=gw size=16 class=iptype></td></tr><tr><td> Netmask </td><td><input type=text name=mask size=16 class=iptype></td></tr><tr><td> Save Change </td><td><input type=submit name=submit onclick="return save(),!1"></td></tr></table></form></div></body></html>