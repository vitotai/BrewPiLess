<!DOCTYPE html><html lang="it"><head><meta http-equiv=content-type content="text/html; charset=utf-8"><meta name=viewport content="width=device-width,initial-scale=1"><title> BrewPiLess Configurazione </title><meta name=apple-mobile-web-app-title content=BrewPiLess><meta name=apple-mobile-web-app-capable content=yes><script>function invoke(e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&(200==n.status?e.success(n.responseText):n.onerror(n.status))},n.ontimeout=function(){void 0!==e.timeout?e.timeout():n.onerror(-1)},n.onerror=function(n){void 0!==e.fail&&e.fail(n)},n.open(e.m,e.url,!0),void 0!==e.data?(n.setRequestHeader("Content-Type",void 0!==e.mime?e.mime:"application/x-www-form-urlencoded"),n.send(e.data)):n.send()}var BWF={process:function(msg){if(null==this.raw)for(var key in eval("m={"+msg+"}"),m)void 0!==this.handlers[key]&&this.handlers[key](m[key]);else this.raw(msg)},on:function(n,e){this.handlers[n]=e},send:function(n){1==this.ws.readyState&&this.ws.send(n)},reconnecting:!1,status:function(){return void 0===this.ws?-1:1==this.ws.readyState?0:1},connect:function(){var e=this;if("undefined"!=typeof WebSocket){var n=new WebSocket("ws://"+document.location.host+"/ws");(e.ws=n).onopen=function(){console.log("Connected"),e.onconnect()},n.onclose=function(){e.reconnecting||(console.log("WS close"),e.error(-2),e.auto&&setTimeout(function(){e.reconnect()},5e3))},n.onmessage=function(n){e.process(n.data)}}else alert("Error! WebSocket Not Supported!")},reconnect:function(n){n=void 0!==n;var e=this;e.reconnecting||(n||1!=e.ws.readyState)&&(console.log("reconnect forced:"+n+" state:"+e.ws.readyState),e.reconnecting=!0,e.ws.close(),e.connect(),e.reconnecting=!1)},init:function(n){var e=this;e.error=void 0===n.error?function(){}:n.error,e.handlers=void 0===n.handlers?{}:n.handlers,e.raw=void 0===n.raw?null:n.raw,e.onconnect=void 0===n.onconnect?function(){}:n.onconnect,e.auto=void 0===n.reconnect||n.reconnect,e.connect()},save:function(n,e,o,t){invoke({m:"POST",url:"/fputs",data:"path="+n+"&content="+encodeURIComponent(e),success:function(){o()},fail:function(n){t(n)}})},load:function(n,e,o){invoke({m:"GET",url:n,success:function(n){e(n)},fail:function(n){o(n)}})}}</script><script>var JSVERSION = "4.4";

function s_ajax(b) {
    var c = new XMLHttpRequest();
    c.onreadystatechange = function() {
        if (c.readyState == 4) {
            if (c.status == 200) {
                b.success(c.responseText)
            } else {
                c.onerror(c.status)
            }
        }
    };
    c.ontimeout = function() {
        if (typeof b["timeout"] != "undefined") b.timeout();
        else c.onerror(-1)
    }, c.onerror = function(a) {
        if (typeof b["fail"] != "undefined") b.fail(a)
    };
    c.open(b.m, b.url, true);
    if (typeof b["data"] != "undefined") {
        c.setRequestHeader("Content-Type", (typeof b["mime"] != "undefined") ? b["mime"] : "application/x-www-form-urlencoded");
        c.send(b.data)
    } else c.send()
}

var Q = function(d) {
    return document.querySelector(d);
};

function doAll(c,act){
    document.querySelectorAll(c).forEach(function(i){act(i)});
}

function C2F(c) {
    return Math.round((c * 1.8 + 32) * 10) / 10
}

function F2C(f) {
    return Math.round((f - 32) / 1.8 * 10) / 10
}

function openDlgLoading() {
    document.getElementById('dlg_loading').style.display = "block";
}

function closeDlgLoading() {
    document.getElementById('dlg_loading').style.display = "none";
}

var BrewMath = {
    abv: function(og, fg) {
        return ((76.08 * (og - fg) / (1.775 - og)) * (fg / 0.794)).toFixed(1);
    },
    abvP: function(og, fg) {
        return BrewMath.abv(BrewMath.pla2sg(og), BrewMath.pla2sg(fg));
    },
    att: function(og, fg) {
        return Math.round((og - fg) / (og - 1) * 100);
    },
    attP: function(pog, pfg) {
        return Math.round((pog - pfg) / pog * 100);
    },
    sg2pla: function(sg) {
        return (((182.4601 * sg - 775.6821) * sg + 1262.7794) * sg - 669.5622);
    },
    pla2sg: function(pla) {
        return 1 + (pla / (258.6 - ((pla / 258.2) * 227.1)));
    },
    tempCorrectionF(sg, t, c) {
        var nsg = sg * ((1.00130346 - 0.000134722124 * t + 0.00000204052596 * t * t - 0.00000000232820948 * t * t * t) /
            (1.00130346 - 0.000134722124 * c + 0.00000204052596 * c * c - 0.00000000232820948 * c * c * c));
        return nsg;
    },
    pTempCorrectionF(sg, t, c) {
        return BrewMath.sg2pla(BrewMath.tempCorrectionF(BrewMath.pla2sg(sg), t, c));
    },
    tempCorrection(celsius, sg, t, c) {
        return celsius ? BrewMath.tempCorrectionF(sg, C2F(t), C2F(c)) : BrewMath.tempCorrectionF(sg, t, c);
    },
    pTempCorrection(celsius, sg, t, c) {
        return celsius ? BrewMath.pTempCorrectionF(sg, C2F(t), C2F(c)) : BrewMath.tempCorrectionF(sg, t, c);
    }
};

Date.prototype.shortLocalizedString = function() {
    var y = this.getYear() + 1900;
    var re = new RegExp('[^\d]?' + y + '[^\d]?');
    var n = this.toLocaleDateString();
    var ds = n.replace(re, "");
    var HH = this.getHours();
    var MM = this.getMinutes();

    function T(x) {
        return (x > 9) ? x : ("0" + x);
    }
    return ds + " " + T(HH) + ":" + T(MM);
};

function getActiveNavItem() {
    var path = window.location.pathname.split("/").pop();
    if (path == "") path = "index.htm";
    var element = Q('.options>li>a[href="/' + path + '"]');
    if(element) element.className += 'active';
}

function formatDate(dt) {
    //	var y = dt.getFullYear();
    //	var M = dt.getMonth() +1;
    //	var d = dt.getDate();
    var h = dt.getHours();
    var m = dt.getMinutes();
    //    var s = dt.getSeconds();
    function dd(n) {
        return (n < 10) ? '0' + n : n;
    }
    //	return dd(M) + "/" + dd(d) + "/" + y +" "+ dd(h) +":"+dd(m)+":"+dd(s);
    //	return dd(M) + "/" + dd(d) +" "+ dd(h) +":"+dd(m);
    return dt.toLocaleDateString() + " " + dd(h) + ":" + dd(m);
}

function formatDateForPicker(date) {
    var h = date.getHours();
    var m = date.getMinutes();

    function dd(n) { return (n < 10) ? '0' + n : n; }
    return date.getFullYear() + "-" + dd(date.getMonth() + 1) + "-" + dd(date.getDate()) + "T" + dd(h) + ":" + dd(m);
}</script><script>function formatIP(ip) {
    if (ip == "0.0.0.0") return "";
    return ip;
}


function loadSetting() {
    s_ajax({
        url: "config?cfg=1",
        m: "GET",
        success: function(data) {
            var j = JSON.parse(data);
            window.oridata = j;
            Object.keys(j).map(function(key) {
                var div = Q("input[name=" + key + "]");
                if (div) {
                    if (div.classList.contains("iptype")) {
                        div.value = formatIP(j[key]);
                    } else if (div.type == "checkbox") div.checked = (j[key] != 0);
                    else div.value = j[key];
                } else {
                    // wifi mode
                    div = Q("select[name=" + key + "]");
                    if (div) {
                        div.value = j[key];
                    }
                }
            });
            // system info
            var mac="";
            for(var i=0;i<j.mac.length;i++){
                mac += ((mac=="")?  "":":") + j.mac[i].toString(16);
            }
            Q("#mac-address").innerText=mac;
            Q("#flash-id").innerText = "0x" + j.fid.toString(16);
            Q("#real-flash-size").innerText=j.frsize;
            Q("#specified-flash-size").innerText=j.fsize;
            Q("#fs-size").innerText=j.fs;
        },
        fail: function(d) {
            alert("errore lettura dati:" + d);
        }
    });
}

function hidesysinfo(){
    Q("#sysinfo").style.display = "none";
}
function showsysinfo(){
    Q("#sysinfo").style.display = "block";
}
function waitrestart() {
    Q("#waitprompt").style.display = "block";
    Q("#inputform").style.display = "none";
    setTimeout(function() {
        window.location.reload();
    }, 15000);
}

function save() {
    var ins = document.querySelectorAll("#sysconfig input");
    var data = "";
    //(new Uint32Array([-1]))[0]
    var json = {};
    var reboot = false;
    Object.keys(ins).map(function(key, i) {
        if (ins[i].type != "submit") {
            if (ins[i].name && ins[i].name != "") {
                var val;
                if (ins[i].type == "checkbox") val = (ins[i].checked ? 1 : 0);
                else val = ins[i].value.trim();
                json[ins[i].name] = val;
                if (window.oridata[ins[i].name] != val && !ins[i].classList.contains("nb"))
                    reboot = true;
            }
        }
    });
    var div = Q("select[name=wifi]");
    json["wifi"] = div.value;
    json["dis"] = Q("select[name=dis]").value;
    //console.log(JSON.stringify(json));
    var url = "config" + (reboot ? "" : "?nb");
    s_ajax({
        url: url,
        data: "data=" + encodeURIComponent(JSON.stringify(json)),
        m: "POST",
        success: function(data) {
            if (reboot) waitrestart();
        },
        fail: function(d) {
            alert("errore scrittura dati:" + d);
        }
    });
}

function load() {
    if (Q("#verinfo")) {
        Q("#verinfo").innerHTML = "v" + JSVERSION;
        getActiveNavItem();
    }
    loadSetting();
    Net.init();

    Q("#submitsave").onclick = function(e) {
        e.preventDefault();
        save();
        return false;
    };
}


function validIP(t) {
    var digits = t.split(".");
    var value = 0;
    if (digits.length != 4) return false;
    for (var i = 0; i < 4; i++) {
        var di = parseInt(digits[i]);
        value = (value << 8) + di;
        if (di > 255) {
            return false;
        }
    }
    return value;
}

var Net = {
    select: function(l) {
        document.getElementById('ssid').value = l.innerText || l.textContent;
        document.getElementById('nwpass').focus();
        return false;
    },
    init: function() {
        this.litem = Q(".nwlist");
        this.litem.parentNode.removeChild(this.litem);
        this.setupEvent();
        this.hide();
    },
    nwevent: function(data) {
        var me = this;
        //console.log("ws:" + data);
        if (typeof data["list"] != "undefined") {
            me.list(data.list);
        } else if (typeof data["ssid"] != "undefined") {
            if (data.ssid != "") {
                Q("#connnected-ssid").innerHTML = data.ssid;
            }
            if (typeof data["ip"] != "undefined")
                if (data.ip != "") {
                    Q("#sta-ip").innerHTML = data.ip;

                }
        }
    },
    rssi: function(x) {
        return (x > 0) ? "?" : Math.min(Math.max(2 * (x + 100), 0), 100);
    },
    list: function(nwlist) {
        var nws = Q("#networks");
        nws.innerHTML = "";
        for (var i = 0; i < nwlist.length; i++) {
            var nl = this.litem.cloneNode(true);
            nl.getElementsByTagName("a")[0].innerHTML = nwlist[i].ssid;
            var signal = nl.getElementsByTagName("span")[0];
            signal.innerHTML = "" + this.rssi(nwlist[i].rssi) + "%";
            if (nwlist[i].enc) signal.className = signal.className + " l";
            nws.appendChild(nl);
        }
    },
    setupEvent: function() {
        var b = this;

        BWF.init({
            handlers: {
                W: function(ev) {
                    b.nwevent(ev);
                }
            }
        });
    },
    scan: function() {
        var lists = Q("#networks");
        lists.innerHTML = "Scanning...";

        s_ajax({
            m: "GET",
            url: "/wifiscan",
            success: function() {}
        });
        return false;
    },
    save: function() {
        var data = "nw=" + encodeURIComponent(Q("#ssid").value);
        if (Q("#nwpass").value != "") data = data + "&pass=" + encodeURIComponent(Q("#nwpass").value);
        var ip = validIP(Q("#staticip").value);
        var gw = validIP(Q("#gateway").value);
        var nm = validIP(Q("#netmask").value);
        var dns = validIP(Q("#dns").value);
        if (ip && gw && nm) {
            data = data + "&ip=" + Q("#staticip").value.trim() +
                "&gw=" + Q("#gateway").value.trim() +
                "&nm=" + Q("#netmask").value.trim() +
                "&dns=" + Q("#dns").value.trim();
        }
        s_ajax({
            m: "POST",
            url: "/wificon",
            data: data,
            success: function() {}
        });
        this.hide();
        return false;
    },
    show: function() {
        Q("#networkselection").style.display = "block";
    },
    hide: function() {
        Q("#networkselection").style.display = "none";
    }
};

function savewifi(){
    Net.save();
    div = Q("select[name=wifi]");
    if(div.value ==2){
        div.value = 3;
        if(typeof window.oridata != "undefined"){
            window.oridata.wifi=3;
        }
    }
}
function initAdvanced(){
    var inputs = document.querySelectorAll('#advanced input,select'), i;

    for (i = 0; i < inputs.length; ++i) {
        inputs[i].onchange = function(){
         //   console.log("item:"+ this.id +" value:" + this.value);
            window.ccModified[this.id]=this.value;
            checkModify();

        }
    } 

    Q("#warning").onchange=function(){
        checkModify();
    }
}


function checkModify(){
    var dirty=false;
    Object.keys(window.ccModified).forEach(key => {
        if(window.ccModified[key] != window.ccConstants[key])
            //console.log("modified:" + key +" value:" + window.ccModified[key]);
        dirty = true;
    });


    Q("#adv-update").disabled= ! Q("#warning").checked || !dirty;
}

function cResponse(cc){
    window.ccModified={};
    window.ccConstants=cc;
    Q("#adv-update").disabled=true;
    Object.keys(cc).forEach(key => {
    //    console.log(key, cc[key]);

        Q("#" + key).value = cc[key];
    });
}
var testConfig={"tempFormat":"C","tempSetMin": 1.0,"tempSetMax": 30.0,"pidMax": 10.000,"Kp": 5.000,"Ki": 0.250,"Kd":-1.500,"iMaxErr": 0.500,"idleRangeH": 1.000,"idleRangeL":-1.000,"heatTargetH": 0.299,"heatTargetL":-0.199,"coolTargetH": 0.199,"coolTargetL":-0.299,"maxHeatTimeForEst":600,"maxCoolTimeForEst":1200,"minCoolTime":180,"minCoolIdleTime":300,"minHeatTime":180,"minHeatIdleTime":300,"deadTime":600,"fridgeFastFilt":1,"fridgeSlowFilt":4,"fridgeSlopeFilt":3,"beerFastFilt":3,"beerSlowFilt":4,"beerSlopeFilt":4,"lah":0,"hs":0};

function showAdvanced(){
    Q("#advanced").style.display = "block";
    if(typeof BWF.handlers['C'] == "undefined"){
        BWF.on('C',cResponse);
        initAdvanced();
    }
    window.ccModified={};
    Q("#adv-update").disabled=true;
    //Test code
    //BWF.handlers.C(testConfig);
    BWF.send("c");
}

function hideAdvanced(){
    Q("#advanced").style.display = "none";
}


function setAdvancedOptions(){
    var cmd={};
    Object.keys(window.ccModified).forEach(key => {
        if(window.ccModified[key] != window.ccConstants[key])
            //console.log("modified:" + key +" value:" + window.ccModified[key]);
        cmd[key] = window.ccModified[key];
    });

    //console.log("j" +JSON.stringify(cmd));
    BWF.send("j" + JSON.stringify(cmd));
}</script><link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet><style>*{-webkit-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0}body,html{height:100%}a{text-decoration:none}html{line-height:1.5;font-family:Roboto,sans-serif;font-weight:400;color:rgba(0,0,0,.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}h1,h2,h3,h4,h5,h6{font-weight:400;line-height:1.1}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:inherit}h1{font-size:4.2rem;line-height:110%;margin:2.1rem 0 1.68rem 0}h2{font-size:3.56rem;line-height:110%;margin:1.78rem 0 1.424rem 0}h3{font-size:2.92rem;line-height:110%;margin:1.46rem 0 1.168rem 0}h4{font-size:2.28rem;line-height:110%;margin:1.14rem 0 .912rem 0}h5{font-size:1.64rem;line-height:110%;margin:.82rem 0 .656rem 0}h6{font-size:1rem;line-height:110%;margin:.5rem 0 .4rem 0}em{font-style:italic}strong{font-weight:500}small{font-size:75%}.light{font-weight:300}.thin{font-weight:200}html [layout],html [layout][horizontal],html [layout][vertical]{display:-webkit-box;display:-ms-flexbox;display:flex}html [layout][horizontal]{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}html [layout][vertical]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}html [flex]{-webkit-box-flex:1;-ms-flex:1;flex:1;-ms-flex-preferred-size:.000000001px;flex-basis:.000000001px}html [layout][center-center],html [layout][cross-center]{-webkit-box-align:center;-ms-flex-align:center;align-items:center}html [layout][cross-end]{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}html [layout][center-center],html [layout][main-center]{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html [layout][main-justified]{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}html [layout][main-distributed]{-ms-flex-pack:distribute;justify-content:space-around}html [hidden]{display:none!important}html [relative]{position:relative}.header{height:64px;background:#009688;-webkit-box-shadow:0 0 4px rgba(0,0,0,.14),0 4px 8px rgba(0,0,0,.28);box-shadow:0 0 4px rgba(0,0,0,.14),0 4px 8px rgba(0,0,0,.28);padding:0 16px;z-index:2}.header_title{font-size:32px;line-height:64px;color:#fff;margin:0;padding:0}.header_version-display{font-size:14px;color:#fff}@media (max-width:700px){[navigation] [menuToggle]{display:block;position:relative;z-index:1;top:3px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}}[navigation] input{display:none}@media (max-width:700px){[navigation] input{display:block;width:40px;height:32px;position:absolute;top:-7px;left:-5px;cursor:pointer;opacity:0;z-index:2;-webkit-touch-callout:none}[navigation] input:checked~ul{-webkit-transform:scale(1,1);transform:scale(1,1);opacity:1}[navigation] input:checked~span{opacity:1;-webkit-transform:rotate(45deg) translate(-2px,-1px);transform:rotate(45deg) translate(-2px,-1px);background:#232323}[navigation] input:checked~span:nth-last-child(3){opacity:0;-webkit-transform:rotate(0) scale(.2,.2);transform:rotate(0) scale(.2,.2)}[navigation] input:checked~span:nth-last-child(2){opacity:1;-webkit-transform:rotate(-45deg) translate(0,-1px);transform:rotate(-45deg) translate(0,-1px)}}[navigation] span{display:none}@media (max-width:700px){[navigation] span{display:block;width:33px;height:4px;margin-bottom:5px;position:relative;background:#fff;border-radius:3px;z-index:1;-webkit-transform-origin:4px 0;transform-origin:4px 0;-webkit-transition:background .5s cubic-bezier(.77,.2,.05,1),opacity .55s ease,-webkit-transform .5s cubic-bezier(.77,.2,.05,1);transition:background .5s cubic-bezier(.77,.2,.05,1),opacity .55s ease,-webkit-transform .5s cubic-bezier(.77,.2,.05,1);transition:transform .5s cubic-bezier(.77,.2,.05,1),background .5s cubic-bezier(.77,.2,.05,1),opacity .55s ease;transition:transform .5s cubic-bezier(.77,.2,.05,1),background .5s cubic-bezier(.77,.2,.05,1),opacity .55s ease,-webkit-transform .5s cubic-bezier(.77,.2,.05,1)}[navigation] span:first-child{-webkit-transform-origin:0 0;transform-origin:0 0}[navigation] span:nth-last-child(2){-webkit-transform-origin:0 100%;transform-origin:0 100%}}[navigation] .options{list-style-type:none;height:100%}[navigation] .options>li{display:inline-block;height:100%}[navigation] .options a{color:#fff;text-transform:uppercase;height:100%;padding:8px;display:inline-block;line-height:48px;border-bottom:3px solid transparent}[navigation] .options a.active{border-bottom:3px solid #ffc107}[navigation] .options a:hover{border-bottom:3px solid #fff}@media (max-width:700px){[navigation] .options{padding-top:64px;position:fixed;display:block;width:100vw;height:100vh;right:0;top:0;background:#ededed;list-style-type:none;-webkit-font-smoothing:antialiased;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translate(100%,0);transform:translate(100%,0);-webkit-transition:-webkit-transform .5s cubic-bezier(.77,.2,.05,1);transition:-webkit-transform .5s cubic-bezier(.77,.2,.05,1);transition:transform .5s cubic-bezier(.77,.2,.05,1);transition:transform .5s cubic-bezier(.77,.2,.05,1),-webkit-transform .5s cubic-bezier(.77,.2,.05,1)}[navigation] .options>li{display:block;height:auto;text-align:center}[navigation] .options a{color:#222;height:auto;width:100%;display:block}[navigation] .options a.active{color:#ffc107;border:none}[navigation] .options a:hover{background:#ccc;border:none}}.footer{height:40px;background:#222;color:rgba(255,255,255,.87);padding:0 16px}.footer a{color:rgba(255,255,255,.87);font-weight:700}[viewport]{min-height:calc(100% - 104px)}@media (max-width:900px){[viewport]{-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-ms-flex-direction:column!important;flex-direction:column!important;min-height:0}}[main]{padding:16px;overflow-y:auto}@media (max-width:900px){[main]{overflow:initial}}@media (max-width:599px){[main]>[layout] .chart-legend{width:100%}}@media (max-width:599px){[main]>[layout]{-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-ms-flex-direction:column!important;flex-direction:column!important}}.error{position:fixed;left:20px;bottom:50px;background-color:#323232;padding:12px 24px 17px 24px;vertical-align:middle;color:#fff;-webkit-box-shadow:0 7px 18px rgba(0,0,0,.2);box-shadow:0 7px 18px rgba(0,0,0,.2)}.error:empty{display:none}input[type=datetime-local],input[type=number],input[type=password],input[type=text]{width:100%;max-width:280px;margin:16px 0;display:block;border:none;padding:18px 0 10px;border-bottom:solid 1px #009688;-webkit-transition:all .3s cubic-bezier(.64,.09,.08,1);transition:all .3s cubic-bezier(.64,.09,.08,1);background:-webkit-gradient(linear,left top,left bottom,color-stop(96%,rgba(255,255,255,0)),color-stop(4%,#009688));background:linear-gradient(to bottom,rgba(255,255,255,0) 96%,#009688 4%);background-position:-100% 0;background-size:100% 100%;background-repeat:no-repeat;color:#00302c}input[type=datetime-local]:focus,input[type=number]:focus,input[type=password]:focus,input[type=text]:focus{-webkit-box-shadow:none;box-shadow:none;outline:0;background-position:0 0}input[type=datetime-local]:focus::-webkit-input-placeholder,input[type=number]:focus::-webkit-input-placeholder,input[type=password]:focus::-webkit-input-placeholder,input[type=text]:focus::-webkit-input-placeholder{color:#009688;font-size:11px;-webkit-transform:translateY(-20px);transform:translateY(-20px);visibility:visible!important;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}input[type=datetime-local]:focus::-moz-placeholder,input[type=number]:focus::-moz-placeholder,input[type=password]:focus::-moz-placeholder,input[type=text]:focus::-moz-placeholder{color:#009688;font-size:11px;transform:translateY(-20px);visibility:visible!important;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}input[type=datetime-local]:focus::-ms-input-placeholder,input[type=number]:focus::-ms-input-placeholder,input[type=password]:focus::-ms-input-placeholder,input[type=text]:focus::-ms-input-placeholder{color:#009688;font-size:11px;transform:translateY(-20px);visibility:visible!important;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}input[type=datetime-local]:focus::placeholder,input[type=number]:focus::placeholder,input[type=password]:focus::placeholder,input[type=text]:focus::placeholder{color:#009688;font-size:11px;-webkit-transform:translateY(-20px);transform:translateY(-20px);visibility:visible!important;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}input[type=datetime-local]:invalid,input[type=number]:invalid,input[type=password]:invalid,input[type=text]:invalid{background:-webkit-gradient(linear,left top,left bottom,color-stop(96%,rgba(255,255,255,0)),color-stop(4%,red));background:linear-gradient(to bottom,rgba(255,255,255,0) 96%,red 4%)}.hide{display:none!important}.card{display:block;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);-webkit-transition:all .3s cubic-bezier(.25,.8,.25,1);transition:all .3s cubic-bezier(.25,.8,.25,1);padding:16px;position:relative;margin-bottom:16px}.card:hover{-webkit-box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22);box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22)}.card-footer{padding:16px 0 0;margin:8px 0 0;border-top:1px solid #ccc;text-align:right}.inline-header{width:140px;min-width:140px;font-weight:700;padding-right:8px}.small-heading{font-size:20px;padding:16px 0 8px}.switch-input{display:none}.switch-label{position:relative;display:inline-block;min-width:148px;cursor:pointer;font-weight:500;text-align:left;margin:0;padding:4px 0 4px 44px}.switch-label:after,.switch-label:before{content:"";position:absolute;margin:0;outline:0;top:50%;-webkit-transform:translate(0,-50%);transform:translate(0,-50%);-webkit-transition:all .3s ease;transition:all .3s ease}.switch-label:before{left:1px;width:34px;height:14px;background-color:#ddd;border-radius:8px}.switch-label:after{left:0;width:20px;height:20px;background-color:#fafafa;border-radius:50%;-webkit-box-shadow:0 3px 1px -2px rgba(0,0,0,.14),0 2px 2px 0 rgba(0,0,0,.098),0 1px 5px 0 rgba(0,0,0,.084);box-shadow:0 3px 1px -2px rgba(0,0,0,.14),0 2px 2px 0 rgba(0,0,0,.098),0 1px 5px 0 rgba(0,0,0,.084)}.switch-input:checked+.switch-label:after{background-color:#4caf50;-webkit-transform:translate(80%,-50%);transform:translate(80%,-50%)}.switch-input:checked+label[for=beer-temp].switch-label:after{background-color:#29aa29}.switch-input:checked+label[for=beer-set].switch-label:after{background-color:#f06464}.switch-input:checked+label[for=fridge-temp].switch-label:after{background-color:#59b8ff}.switch-input:checked+label[for=fridge-set].switch-label:after{background-color:#ffa14c}.switch-input:checked+label[for=room-temp].switch-label:after{background-color:#aaa}.switch-input:checked+label[for=gravity].switch-label:after{background-color:#909}.switch-input:checked+label[for=aux-temp].switch-label:after{background-color:#f5e127}.switch-input:checked+label[for=filtersg].switch-label:after{background-color:#000abb}.switch-input:checked+label[for=pressure].switch-label:after{background-color:#00e}.switch-input:checked+label[for=pressure-set].switch-label:after{background-color:#f06464}.switch-input:checked+label[for=carbonation].switch-label:after{background-color:#aaa}.switch-input:checked+label[for=humidity].switch-label:after{background-color:#22d}.switch-input:checked+label[for=humidity-set].switch-label:after{background-color:#e11}.switch-input:checked+label[for=room-humidity].switch-label:after{background-color:#aaa}.switch-input:checked+label[for=sgchange1].switch-label:after{background-color:#d3d}.switch-input:checked+label[for=sgchange2].switch-label:after{background-color:#33d}.switch-input:checked+label[for=sgchange3].switch-label:after{background-color:#3d3}.btn{display:inline-block;position:relative;cursor:pointer;height:35px;line-height:35px;padding:0 1.5rem;font-size:15px;font-weight:600;letter-spacing:.8px;text-align:center;text-transform:uppercase;vertical-align:middle;white-space:nowrap;outline:0;border:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all .3s ease-out;transition:all .3s ease-out;background-color:transparent;margin-right:8px}.btn[disabled]{color:#bdbdbd}.btn[disabled]:hover{background-color:transparent;cursor:not-allowed}.btn--raised{background-color:#009688;color:#fff;-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12)}.btn--raised:hover{background-color:#00635a}.btn--primary{color:#009688}.btn:hover{background-color:rgba(153,153,153,.2);cursor:pointer}.modal{display:none;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:fixed;top:0;left:0;right:0;bottom:0;overflow-y:auto;overflow-x:hidden;z-index:1000;-webkit-transition:all .5s cubic-bezier(.23,1,.32,1);transition:all .5s cubic-bezier(.23,1,.32,1);-webkit-transition-delay:0s;transition-delay:0s;background:rgba(0,0,0,.3)}.modal-content{position:relative;padding:2.4rem;background:#fff;background-clip:padding-box;-webkit-box-shadow:0 12px 15px 0 rgba(0,0,0,.25);box-shadow:0 12px 15px 0 rgba(0,0,0,.25);-webkit-transition:all .25s cubic-bezier(.23,1,.32,1);transition:all .25s cubic-bezier(.23,1,.32,1);max-width:600px;padding:2rem;margin-left:auto;margin-right:auto}.modal-content h2.message{font-size:18px;font-weight:700;text-transform:uppercase}#waitprompt{display:none}.center{text-align:center}div,input{padding:5px;font-size:1em}.modal-header{font-weight:700;font-size:1.2em}.modal input{width:95%}#networkselection button{border:0;border-radius:.3rem;background-color:#1fa3ec;color:#fff;line-height:2.4rem;font-size:1.2rem;width:96%;margin:4px}.scannednetwork{float:right;width:64px;text-align:right}.l{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAALVBMVEX///8EBwfBwsLw8PAzNjaCg4NTVVUjJiZDRUUUFxdiZGSho6OSk5Pg4eFydHTCjaf3AAAAZElEQVQ4je2NSw7AIAhEBamKn97/uMXEGBvozkWb9C2Zx4xzWykBhFAeYp9gkLyZE0zIMno9n4g19hmdY39scwqVkOXaxph0ZCXQcqxSpgQpONa59wkRDOL93eAXvimwlbPbwwVAegLS1HGfZAAAAABJRU5ErkJggg==) no-repeat left center;background-size:1em}#networkselection{text-align:left;display:inline-block;min-width:260px}#advanced input{width:4em;margin-right:1em;margin-top:2px;padding:0}#advanced .inline-header{width:65%}#advanced .modal-header{border-bottom:#00635a 2px solid}</style></head><body onload=load()><header layout horizontal main-justified cross-center relative class=header><h1 class=header_title><span id=hostname>BrewPiLess</span> <span id=verinfo class=header_version-display></span></h1><div navigation><div menutoggle><input type=checkbox> <span></span> <span></span> <span></span><ul class=options><li><a href=/index.htm> grafico </a></li><li><a href=/control.htm> controllo </a></li><li><a href=/logging.htm> logs </a></li><li><a href=/setup.htm> dispositivo </a></li><li><a href=/config.htm> sistema </a></li><li><a href=/gravity.htm> densità </a></li><li><a href=/pressure.htm> Pressione </a></li></ul></div></div></header><div viewport layout vertical><div id=inputform main><div id=sysconfig class=card><form action=/setconfig action=post><h5> BrewPiLess Configurazione </h5><div layout horizontal cross-center><h6 class=inline-header> LCD auto off </h6><input name=aoff type=text size=5 maxlength=5 class=nb></div><div layout horizontal cross-center><h6 class=inline-header> LCD Display </h6><select id=display name=dis class=nb><option value=0>Rotate</option><option value=1>BrewPi</option><option value=2>Additional</option></select></div><div layout horizontal cross-center><h6 class=inline-header>Glycol Chilling</h6><div><input type=checkbox id=glycol name=glycol class=switch-input checked> <label for=glycol class=switch-label style=min-width:0></label></div></div><div layout horizontal cross-center><h6 class=inline-header> Titolo </h6><input name=title type=text size=12 maxlength=24></div><div layout horizontal cross-center><h6 class=inline-header> Host/Rete Nome </h6><input name=name type=text size=12 maxlength=16></div><div layout horizontal cross-center><h6 class=inline-header> HTTP Porta </h6><input name=port type=text size=5 maxlength=5></div><div layout horizontal cross-center><h6 class=inline-header> User Name </h6><input name=user type=text size=12 maxlength=16></div><div layout horizontal cross-center><h6 class=inline-header> Password </h6><input name=pass type=password size=12 maxlength=16></div><div layout horizontal cross-center><h6 class=inline-header> Chiedi sempre la password </h6><input type=checkbox id=protect name=protect class=switch-input checked> <label for=protect class=switch-label style=min-width:0></label></div><div layout horizontal cross-center><h6 class=inline-header> Modalità rete </h6><select name=wifi><option value=1>Station</option><option value=2>AP</option><option value=3>Station + AP</option></select></div><div layout horizontal cross-center><h6 class=inline-header> Rete </h6><button id=connnected-ssid class="btn btn--raised" onclick="return Net.show(),!1">...</button></div><div layout horizontal cross-center><h6 class=inline-header> IP </h6><span id=sta-ip></span></div><div layout horizontal cross-center><button class="btn btn--raised" onclick="return showsysinfo(),!1">Sysinfo</button> <button class="btn btn--raised" onclick='return Backup.init(),!(Q("#backup-diag").style.display="block")'>Backup/Restore</button> <button class="btn btn--raised" onclick="return showAdvanced(),!1">Advanced</button></div><div class=card-footer><input type=submit id=submitsave name=submit class=btn></div></form></div></div></div><div id=networkselection class=modal><div class=modal-content><div class=modal-header> Selezione rete </div><div id=networks><div class=nwlist><a href=# onclick=Net.select(this) class=ssid>N</a>&nbsp;<span class=scannednetwork></span></div></div><div class=center><a href=# onclick="return Net.scan()"> Scan </a></div><form method=get action=#><input id=ssid name=ssid length=32 placeholder=SSID><br><input id=nwpass name=nwpass length=64 type=password placeholder=password><br><br><input id=staticip name=ip length=1 placeholder="IP fisso" class="nb iptype"><br><input id=gateway name=gw length=1 placeholder="Gateway" class="nb iptype"><br><input id=netmask name=mask length=1 placeholder="Netmask" class="nb iptype"><br><input id=dns name=dns length=1 placeholder="DNS" class="nb iptype"><br><br><button type=button onclick="return savewifi()">Salva modifiche</button> <button onclick="return Net.hide(),!1">Cancella</button></form></div></div><footer layout horizontal main-justified cross-center class=footer><span>BrewPiLess by <a href=https://github.com/vitotai/ >vitotai</a></span> <span><a href=https://github.com/vitotai/BrewPiLess/ >project on GitHub</a></span></footer><div id=waitprompt class=modal><div class=modal-content> Configuration saved. Wait for restart... (note: if the hostname is changed, the page won't be reloaded.) </div></div><div id=sysinfo class=modal><div class=modal-content style=width:320px><div class=modal-header>System Information</div><ul><li layout horizontal main-justified><span class=descriptor>MAC Address</span> <span id=mac-address></span></li><li layout horizontal main-justified><span class=descriptor>Flash Chip ID</span> <span id=flash-id></span></li><li layout horizontal main-justified><span class=descriptor>Real Flash Size</span> <span id=real-flash-size></span></li><li layout horizontal main-justified><span class=descriptor>Specified Flash Size</span> <span id=specified-flash-size></span></li><li layout horizontal main-justified><span class=descriptor>File System Size</span> <span id=fs-size></span></li></ul><button class="btn btn--raised" onclick="return hidesysinfo(),!1">Done</button></div></div><div id=backup-diag class=modal><div class=modal-content><div class=modal-header> Setting Backup/Restore </div><ul><li layout horizontal main-justified><span class=descriptor>Backup Time </span><span id=backuptime></span></li><li layout horizontal main-justified><span> dispositivo</span><span class=device-status></span></li><li layout horizontal main-justified><span> densità</span><span class=gdc-status></span></li><li layout horizontal main-justified><span>logs</span><span class=rlog-status></span></li><li layout horizontal main-justified><span>Pressione</span><span class=pressure-status></span></li><li layout horizontal main-justified><span>MQTT</span><span class=mqtt-status></span></li><li layout horizontal main-justified><span>sistema</span><span class=syscfg-status></span></li></ul><div class=modal id=processing><div class="modal-content hint" id=hint_get>Retriving data...</div><div class="modal-content hint" id=hint_put>Sending data to controller...</div></div><button onclick="return Backup.save(),!1">Save </button> Restore from <input type=file id=backupfile> <button onclick="return Backup.restore(),!1"> Restore </button> <button onclick='return!(Q("#backup-diag").style.display="none")'>Cancella </button></div></div><div id=advanced class=modal><div class=modal-content><div class=modal-header>Advanced Settings</div><div layout horizontal cross-center><h6 class=inline-header>tempFormat</h6><div><select id=tempFormat name=tempFormat><option value=C>&deg;C</option><option value=F>&deg;F</option></select></div></div><div layout horizontal cross-center><h6 class=inline-header>tempSettingMin</h6><input type=number id=tempSetMin size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>tempSettingMax</h6><input type=number id=tempSetMax size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>pidMax</h6><input type=number id=pidMax size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>Kp</h6><input type=number id=Kp size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>Ki</h6><input type=number id=Ki size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>Kd</h6><input type=number id=Kd size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>iMaxErr</h6><input type=number id=iMaxErr size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>idleRangeH</h6><input type=number id=idleRangeH size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>idleRangeL</h6><input type=number id=idleRangeL size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>heatTargetH</h6><input type=number id=heatTargetH size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>heatTargetL</h6><input type=number id=heatTargetL size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>coolTargetH</h6><input type=number id=coolTargetH size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>coolTargetL</h6><input type=number id=coolTargetL size=4 step=0.001> &deg;</div><div layout horizontal cross-center><h6 class=inline-header>maxHeatTimeForEst</h6><input type=number id=maxHeatTimeForEst size=4> Seconds</div><div layout horizontal cross-center><h6 class=inline-header>maxCoolTimeForEst</h6><input type=number id=maxCoolTimeForEst size=4> Seconds</div><div layout horizontal cross-center><h6 class=inline-header>fridgeFastFilt</h6><input type=number id=fridgeFastFilt size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>fridgeSlowFilt</h6><input type=number id=fridgeSlowFilt size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>fridgeSlopeFilt</h6><input type=number id=fridgeSlopeFilt size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>beerFastFilt</h6><input type=number id=beerFastFilt size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>beerSlowFilt</h6><input type=number id=beerSlowFilt size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>beerSlopeFilt</h6><input type=number id=beerSlopeFilt size=4 step=0.001></div><div layout horizontal cross-center><h6 class=inline-header>lightAsHeater</h6><div><select id=lah name=lah><option value=0>NO</option><option value=1>YES</option></select></div></div><div layout horizontal cross-center><h6 class=inline-header>RotaryHalfStep</h6><div><select id=hs name=hs><option value=0>NO</option><option value=1>YES</option></select></div></div><div layout horizontal cross-center><h6 class=inline-header>minCoolTime</h6><input type=number id=minCoolTime size=4> Seconds</div><div layout horizontal cross-center><h6 class=inline-header>minCoolIdleTime</h6><input type=number id=minCoolIdleTime size=4> Seconds</div><div layout horizontal cross-center><h6 class=inline-header>minHeatTime</h6><input type=number id=minHeatTime size=4> Seconds</div><div layout horizontal cross-center><h6 class=inline-header>minHeatIdleTime</h6><input type=number id=minHeatIdleTime size=4> Seconds</div><div layout horizontal cross-center><h6 class=inline-header>deadTime</h6><input type=number id=deadTime size=4> Seconds</div><hr><div><input type=checkbox id=warning name=warning> <label for=warning style=min-width:0>I understand the risk of modifying these values.</label></div><div style=text-align:center><button class="btn btn--raised" onclick=setAdvancedOptions() id=adv-update>Update</button> <button class="btn btn--raised" onclick=hideAdvanced()>Close</button></div></div></div></body></html>